<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>wwwApp: email.php File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">wwwApp</div>
   <div id="projectbrief">A web app for workshop organizing, recruitment and qualification</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">email.php File Reference</div>  </div>
</div>
<div class="contents">

<p><a href="email_8php_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="email_8php.html#a4d9b10638d7c2d561789ed42890fba01">sendMail</a> ($subject, $content, $to, $isHTML=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="email_8php.html#a78a08cf70ac9dcae19e486bec76e5dae">actionFetchGmailOAuthAccessToken</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="email_8php.html#a448ba694817751ab786830fbb87eb26d">getGoogleOAuthOptions</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="email_8php.html#aa3a9309a85ee07109928a7ad0525db0f">getCurrentUrl</a> ($includeQuery=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="email_8php.html#a73637e760498c5cea55074896ec982ac">validEmail</a> ($email)</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a78a08cf70ac9dcae19e486bec76e5dae"></a><!-- doxytag: member="email.php::actionFetchGmailOAuthAccessToken" ref="a78a08cf70ac9dcae19e486bec76e5dae" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">actionFetchGmailOAuthAccessToken </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="email_8php_source.html#l00144">144</a> of file <a class="el" href="email_8php_source.html">email.php</a>.</p>
<div class="fragment"><pre class="fragment">{
        global <a class="code" href="common_8php.html#a7dc56dc8b18ad37272b56fa7395bedef">$DB</a>, <a class="code" href="index_8php.html#ae1848ae8dc4014bc7c680e5504a8eef0">$PAGE</a>;
        <span class="keywordflow">if</span> (!<a class="code" href="user_2utils_8php.html#ae6297fbd3e8fa7cc5feb6411a80deee9">userIs</a>(<span class="stringliteral">&#39;admin&#39;</span>))  <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPolicyException.html">PolicyException</a>();
        <a class="code" href="log_8php.html#a5eaecfade7f5e117c98d7635b2aba95f">logUser</a>(<span class="stringliteral">&#39;redoOAuth&#39;</span>);
        $consumer = <span class="keyword">new</span> Zend_Oauth_Consumer(<a class="code" href="email_8php.html#a448ba694817751ab786830fbb87eb26d">getGoogleOAuthOptions</a>());
        <span class="keywordflow">if</span> (!isset($_SESSION[<span class="stringliteral">&#39;REQUEST_TOKEN&#39;</span>])) {
                <span class="comment">// Get Request Token and redirect to Google</span>
                $scopes = array(<span class="stringliteral">&#39;https://mail.google.com/&#39;</span>);
                $_SESSION[<span class="stringliteral">&#39;REQUEST_TOKEN&#39;</span>] = serialize($consumer-&gt;getRequestToken(array(<span class="stringliteral">&#39;scope&#39;</span> =&gt; implode(<span class="charliteral">&#39; &#39;</span>, $scopes))));
                $consumer-&gt;redirect();
        } <span class="keywordflow">else</span> {
                <span class="comment">// Have Request Token already, Get Access Token</span>
                $requestToken = unserialize($_SESSION[<span class="stringliteral">&#39;REQUEST_TOKEN&#39;</span>]);
                unset($_SESSION[<span class="stringliteral">&#39;REQUEST_TOKEN&#39;</span>]);
                $accessToken = $consumer-&gt;getAccessToken($_GET, $requestToken);
                $accessToken = base64_encode(serialize($accessToken));
                $DB-&gt;options[<span class="stringliteral">&#39;gmailOAuthAccessToken&#39;</span>]-&gt;update(array(<span class="stringliteral">&#39;value&#39;</span> =&gt; $accessToken));
                $PAGE-&gt;addMessage(<span class="stringliteral">&quot;Successfully received accessToken: &lt;pre&gt;$accessToken&lt;/pre&gt;&quot;</span>, <span class="stringliteral">&#39;success&#39;</span>);
                <a class="code" href="index_8php.html#a6e8525da6dad002542958c13132118e4">callAction</a>(<span class="stringliteral">&#39;editOptions&#39;</span>);
        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa3a9309a85ee07109928a7ad0525db0f"></a><!-- doxytag: member="email.php::getCurrentUrl" ref="aa3a9309a85ee07109928a7ad0525db0f" args="($includeQuery=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getCurrentUrl </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>includeQuery</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="email_8php_source.html#l00185">185</a> of file <a class="el" href="email_8php_source.html">email.php</a>.</p>

<p>Referenced by <a class="el" href="email_8php_source.html#l00167">getGoogleOAuthOptions()</a>.</p>
<div class="fragment"><pre class="fragment">                                             {
  $scheme =  empty($_SERVER[<span class="stringliteral">&#39;HTTPS&#39;</span>]) ? <span class="stringliteral">&#39;http&#39;</span> : <span class="stringliteral">&#39;https&#39;</span>;
  $hostname = $_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>];
  $port = $_SERVER[<span class="stringliteral">&#39;SERVER_PORT&#39;</span>];
  $uri = ($includeQuery) ? $_SERVER[<span class="stringliteral">&#39;REQUEST_URI&#39;</span>] : $_SERVER[<span class="stringliteral">&#39;SCRIPT_NAME&#39;</span>];
  <span class="keywordflow">if</span> (($port == <span class="stringliteral">&#39;80&#39;</span> &amp;&amp; $scheme == <span class="stringliteral">&#39;http&#39;</span>) || ($port == <span class="stringliteral">&#39;443&#39;</span> &amp;&amp; $scheme == <span class="stringliteral">&#39;https&#39;</span>))
      $url = $scheme . <span class="stringliteral">&#39;://&#39;</span> . $hostname . $uri;
  <span class="keywordflow">else</span>
      $url = $scheme . <span class="stringliteral">&#39;://&#39;</span> . $hostname . <span class="charliteral">&#39;:&#39;</span> . $port . $uri;
  <span class="keywordflow">return</span> $url;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a448ba694817751ab786830fbb87eb26d"></a><!-- doxytag: member="email.php::getGoogleOAuthOptions" ref="a448ba694817751ab786830fbb87eb26d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getGoogleOAuthOptions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="email_8php_source.html#l00167">167</a> of file <a class="el" href="email_8php_source.html">email.php</a>.</p>

<p>Referenced by <a class="el" href="email_8php_source.html#l00144">actionFetchGmailOAuthAccessToken()</a>, and <a class="el" href="email_8php_source.html#l00053">sendMail()</a>.</p>
<div class="fragment"><pre class="fragment">{
        <span class="keywordflow">return</span> array(
                <span class="stringliteral">&#39;requestScheme&#39;</span> =&gt; Zend_Oauth::REQUEST_SCHEME_HEADER,
                <span class="stringliteral">&#39;version&#39;</span> =&gt; <span class="stringliteral">&#39;1.0&#39;</span>,
                <span class="stringliteral">&#39;consumerKey&#39;</span> =&gt; OAUTH_CONSUMER_KEY,
                <span class="stringliteral">&#39;signatureMethod&#39;</span> =&gt; OAUTH_METHOD,
                <span class="stringliteral">&#39;consumerSecret&#39;</span> =&gt;
                        (OAUTH_METHOD == <span class="stringliteral">&#39;RSA-SHA1&#39;</span>) ?
                                <span class="keyword">new</span> Zend_Crypt_Rsa_Key_Private(file_get_contents(OAUTH_CONSUMER_SECRET)) :
                                OAUTH_CONSUMER_SECRET,
                <span class="stringliteral">&#39;callbackUrl&#39;</span> =&gt; <a class="code" href="email_8php.html#aa3a9309a85ee07109928a7ad0525db0f">getCurrentUrl</a>(),
                <span class="stringliteral">&#39;requestTokenUrl&#39;</span> =&gt; <span class="stringliteral">&#39;https://www.google.com/accounts/OAuthGetRequestToken&#39;</span>,
                <span class="stringliteral">&#39;userAuthorizationUrl&#39;</span> =&gt; <span class="stringliteral">&#39;https://www.google.com/accounts/OAuthAuthorizeToken&#39;</span>,
                <span class="stringliteral">&#39;accessTokenUrl&#39;</span> =&gt; <span class="stringliteral">&#39;https://www.google.com/accounts/OAuthGetAccessToken&#39;</span>
        );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4d9b10638d7c2d561789ed42890fba01"></a><!-- doxytag: member="email.php::sendMail" ref="a4d9b10638d7c2d561789ed42890fba01" args="($subject, $content, $to, $isHTML=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sendMail </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>subject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>isHTML</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="email_8php_source.html#l00053">53</a> of file <a class="el" href="email_8php_source.html">email.php</a>.</p>

<p>Referenced by <a class="el" href="user_8php_source.html#l00283">actionPasswordReset()</a>, <a class="el" href="user_8php_source.html#l00172">actionRegister()</a>, <a class="el" href="utils_8php_source.html#l00259">actionReportBugForm()</a>, and <a class="el" href="error_8php_source.html#l00151">errorHandler()</a>.</p>
<div class="fragment"><pre class="fragment">{
        <span class="keywordflow">if</span> (<a class="code" href="config_8php_8template.html#adfc49e30b41195223c0f9e57dd4a1c1e">EMAIL_METHOD</a> == <span class="stringliteral">&#39;display&#39;</span>)
        {
                $message = <span class="stringliteral">&quot;</span>
<span class="stringliteral">                        Gdyby nie włączone debugowanie, wysłano by maila:&lt;br/&gt;</span>
<span class="stringliteral">                        SUBJECT: &lt;i&gt;$subject&lt;i&gt;&lt;br/&gt;</span>
<span class="stringliteral">                        TO: &lt;i&gt;&quot;</span>. json_encode($to) .<span class="stringliteral">&quot;&lt;/i&gt;&lt;br/&gt;</span>
<span class="stringliteral">                        CONTENT(html=&quot;</span>. json_encode($isHTML) .<span class="stringliteral">&quot;):&lt;br/&gt;</span>
<span class="stringliteral">                        $content</span>
<span class="stringliteral">                &quot;</span>;
                global <a class="code" href="index_8php.html#ae1848ae8dc4014bc7c680e5504a8eef0">$PAGE</a>;
                <span class="keywordflow">if</span> ($PAGE)
                        $PAGE-&gt;addMessage($message);
                <span class="keywordflow">else</span>
                        echo $message;
        }
        <span class="comment">/*</span>
<span class="comment">        // unmaintained (doesn&#39;t support $from = array(array(&#39;John&#39;,&#39;a@a&#39;),...))</span>
<span class="comment">        else if (EMAIL_METHOD == &#39;simple&#39;)</span>
<span class="comment">        {</span>
<span class="comment">                if (!$isHTML)</span>
<span class="comment">                        $content .= &quot;\n__\nEmail automatycznie wysłany z &quot;. $_SERVER[&#39;HTTP_HOST&#39;];</span>
<span class="comment">                $from = &#39;noreply@warsztatywww.nstrefa.pl&#39;;</span>
<span class="comment">                ini_set(&quot;sendmail_from&quot;, $from);</span>
<span class="comment">                mail($to, &quot;[WWW][app] $subject&quot;, $content , &quot;From: $from&quot;, &quot;-f$from&quot;);</span>
<span class="comment">        }</span>
<span class="comment">        */</span>

        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="config_8php_8template.html#adfc49e30b41195223c0f9e57dd4a1c1e">EMAIL_METHOD</a> == <span class="stringliteral">&#39;gmail&#39;</span>)
        {
                $email_address = <a class="code" href="utils_8php.html#a86acce3c002ca1af709fd1b04f2f82fa">getOption</a>(<span class="stringliteral">&#39;gmailOAuthEmail&#39;</span>);
                <span class="keywordflow">if</span> (!$isHTML)
                        $content .= <span class="stringliteral">&quot;\n__\nEmail automatycznie wysłany z &quot;</span>. $_SERVER[<span class="stringliteral">&#39;HTTP_HOST&#39;</span>];

                $config = <span class="keyword">new</span> Zend_Oauth_Config();
                $config-&gt;setOptions(<a class="code" href="email_8php.html#a448ba694817751ab786830fbb87eb26d">getGoogleOAuthOptions</a>());
                <span class="comment">// Could try-catch here (for &#39;access disallowed&#39;?)</span>
                $config-&gt;setToken(unserialize(base64_decode(<a class="code" href="utils_8php.html#a86acce3c002ca1af709fd1b04f2f82fa">getOption</a>(<span class="stringliteral">&#39;gmailOAuthAccessToken&#39;</span>))));
                $config-&gt;setRequestMethod(<span class="stringliteral">&#39;GET&#39;</span>);
                $url = <span class="stringliteral">&#39;https://mail.google.com/mail/b/&#39;</span> . $email_address . <span class="stringliteral">&#39;/smtp/&#39;</span>;

                $httpUtility = <span class="keyword">new</span> Zend_Oauth_Http_Utility();
                $params = $httpUtility-&gt;assembleParams($url, $config);
                ksort($params);
                $oauthParams = array();
                <span class="keywordflow">foreach</span> ($params as $key =&gt; $value)
                        <span class="keywordflow">if</span> (strpos($key, <span class="stringliteral">&#39;oauth_&#39;</span>) === 0)
                                $oauthParams []= $key . <span class="stringliteral">&#39;=&quot;&#39;</span> . urlencode($value) . <span class="charliteral">&#39;&quot;&#39;</span>;
                $initClientRequest = <span class="stringliteral">&#39;GET &#39;</span> . $url . <span class="charliteral">&#39; &#39;</span> . implode(<span class="charliteral">&#39;,&#39;</span>, $oauthParams);

                $config = array(
                        <span class="stringliteral">&#39;ssl&#39;</span> =&gt; <span class="stringliteral">&#39;ssl&#39;</span>,
                        <span class="stringliteral">&#39;port&#39;</span> =&gt; <span class="stringliteral">&#39;465&#39;</span>,
                        <span class="stringliteral">&#39;auth&#39;</span> =&gt; <span class="stringliteral">&#39;xoauth&#39;</span>,
                        <span class="stringliteral">&#39;xoauth_request&#39;</span> =&gt; base64_encode($initClientRequest)
                );
                $transport = <span class="keyword">new</span> Zend_Mail_Transport_Smtp(<span class="stringliteral">&#39;smtp.gmail.com&#39;</span>, $config);
                $mail = <span class="keyword">new</span> Zend_Mail(<span class="stringliteral">&#39;UTF-8&#39;</span>);
                <span class="keywordflow">if</span> ($isHTML)  $mail-&gt;setBodyHTML($content);
                <span class="keywordflow">else</span>          $mail-&gt;setBodyText($content);
                $mail-&gt;setFrom($email_address, <span class="stringliteral">&#39;Aplikacja WWW&#39;</span>);
                <span class="keywordflow">if</span> (is_array($to))
                        <span class="keywordflow">foreach</span> ($to as $t)
                                $mail-&gt;addTo($t[1], $t[0]);
                <span class="keywordflow">else</span>  $mail-&gt;addTo($to);
                $mail-&gt;setSubject(<span class="stringliteral">&quot;[WWW][app] $subject&quot;</span>);
                $mail-&gt;send($transport);

                <span class="comment">/* If you ever needed to access IMAP this way too: */</span>
                <span class="comment">//require_once &#39;Zend/Mail/Protocol/Imap.php&#39;;</span>
                <span class="comment">//require_once &#39;Zend/Mail/Storage/Imap.php&#39;;</span>
                <span class="comment">/*</span>
<span class="comment">                $imap = new Zend_Mail_Protocol_Imap(&#39;imap.gmail.com&#39;, &#39;993&#39;, true);</span>
<span class="comment">                $authenticateParams = array(&#39;XOAUTH&#39;, base64_encode($initClientRequest));</span>
<span class="comment">                $imap-&gt;requestAndResponse(&#39;AUTHENTICATE&#39;, $authenticateParams);</span>
<span class="comment"></span>
<span class="comment">                $storage = new Zend_Mail_Storage_Imap($imap);</span>
<span class="comment"></span>
<span class="comment">                echo &#39;&lt;html&gt;&lt;head&gt;&lt;title&gt;2legged OAuth test&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&#39;;</span>
<span class="comment">                echo &#39;&lt;h1&gt;Total messages: &#39; . $storage-&gt;countMessages() . &quot;&lt;/h1&gt;\n&quot;;</span>
<span class="comment"></span>
<span class="comment">                echo &#39;First five messages: &lt;ul&gt;&#39;;</span>
<span class="comment">                for ($i = 1; $i &lt;= $storage-&gt;countMessages() &amp;&amp; $i &lt;= 5; $i++ )</span>
<span class="comment">                        echo &#39;&lt;li&gt;&#39; . htmlentities($storage-&gt;getMessage($i)-&gt;subject) . &quot;&lt;/li&gt;\n&quot;;</span>
<span class="comment">                echo &#39;&lt;/ul&gt;&#39;;</span>
<span class="comment">                echo &#39;&lt;/body&gt;&lt;/html&gt;&#39;;</span>
<span class="comment">                */</span>
        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a73637e760498c5cea55074896ec982ac"></a><!-- doxytag: member="email.php::validEmail" ref="a73637e760498c5cea55074896ec982ac" args="($email)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validEmail </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>email</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="email_8php_source.html#l00201">201</a> of file <a class="el" href="email_8php_source.html">email.php</a>.</p>

<p>Referenced by <a class="el" href="form_8php_source.html#l00169">Form::validate()</a>.</p>
<div class="fragment"><pre class="fragment">{
        $isValid = <span class="keyword">true</span>;
        $atIndex = strrpos($email, <span class="stringliteral">&quot;@&quot;</span>);
        <span class="keywordflow">if</span> (is_bool($atIndex) &amp;&amp; !$atIndex)  <span class="keywordflow">return</span> <span class="keyword">false</span>;

    $domain = substr($email, $atIndex+1);
    $local = substr($email, 0, $atIndex);
    $localLen = strlen($local);
    $domainLen = strlen($domain);
    <span class="keywordflow">if</span> ($localLen &lt; 1 || $localLen &gt; 64)  <span class="keywordflow">return</span> <span class="keyword">false</span>;          <span class="comment">// local part length exceeded</span>
    <span class="keywordflow">if</span> ($domainLen &lt; 1 || $domainLen &gt; 255)  <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// domain part length exceeded</span>
    <span class="keywordflow">if</span> ($local[0] == <span class="charliteral">&#39;.&#39;</span> || $local[$localLen-1] == <span class="charliteral">&#39;.&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// local part starts or ends with &#39;.&#39;</span>
    <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/\\.\\./&#39;</span>, $local))  <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// local part has two consecutive dots</span>
    <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&#39;/^[A-Za-z0-9\\-\\.]+$/&#39;</span>, $domain))  <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// character not valid in domain part</span>
    <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/\\.\\./&#39;</span>, $domain))  <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// domain part has two consecutive dots</span>
    <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&#39;/^(\\\\.|[A-Za-z0-9!#%&amp;`_=\\/$\&#39;*+?^{}|~.-])+$/&#39;</span>,
                 str_replace(<span class="stringliteral">&quot;\\\\&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,$local)))
    {
       <span class="comment">// character not valid in local part unless</span>
       <span class="comment">// local part is quoted</span>
       <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&#39;/^&quot;(\\\\&quot;|[^&quot;])+&quot;$/&#39;</span>,
           str_replace(<span class="stringliteral">&quot;\\\\&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,$local)))  <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="keywordflow">if</span> (DEBUG&lt;1 &amp;&amp; !(checkdnsrr($domain,<span class="stringliteral">&quot;MX&quot;</span>) ||  checkdnsrr($domain,<span class="stringliteral">&quot;A&quot;</span>)))  <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// domain not found in DNS</span>
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Sat Aug 13 2011 for wwwApp by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
